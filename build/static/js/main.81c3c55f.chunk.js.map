{"version":3,"sources":["App.js","index.js"],"names":["getData","limit","offset","Axios","get","params","id","then","res","data","hotCommentInst","commentInst","page","CommentCard","avatarUrl","nickname","content","time","className","style","backgroundColor","src","alt","timestamp","formats","zero","value","myDate","Date","year","getFullYear","month","getMonth","day","getDate","hour","getHours","minite","getMinutes","second","getSeconds","replace","matches","Y","m","d","H","i","s","dateFormat","App","useState","hotComments","setHotComments","comments","setComments","loading","setLoading","loadMore","concat","pack","update","finally","useEffect","sizeOpt","columns","gutter","mq","Bricks","container","packed","sizes","textAlign","scrolling","border","frameborder","framespacing","allowfullscreen","width","height","map","user","commentId","key","onClick","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.81c3c55f.chunk.js","sourcesContent":["/* eslint-disable jsx-a11y/iframe-has-title */\nimport React, { useEffect, useState } from \"react\";\nimport Axios from \"axios\";\nimport Bricks from \"bricks.js\";\nimport \"./App.css\";\n\nfunction getData(limit = 50, offset) {\n  return Axios.get(\"https://musicapi.leanapp.cn/comment/music\", {\n    params: {\n      id: 186016,\n      limit,\n      offset, // 倒叙\n    },\n  }).then((res) => res.data);\n}\n\nfunction dateFormat(timestamp, formats) {\n  formats = formats || \"Y-m-d\";\n\n  const zero = (value) => {\n    if (value < 10) {\n      return \"0\" + value;\n    }\n    return value;\n  };\n\n  const myDate = timestamp ? new Date(timestamp) : new Date();\n\n  const year = myDate.getFullYear();\n  const month = zero(myDate.getMonth() + 1);\n  const day = zero(myDate.getDate());\n\n  const hour = zero(myDate.getHours());\n  const minite = zero(myDate.getMinutes());\n  const second = zero(myDate.getSeconds());\n\n  return formats.replace(/Y|m|d|H|i|s/gi, function (matches) {\n    return {\n      Y: year,\n      m: month,\n      d: day,\n      H: hour,\n      i: minite,\n      s: second,\n    }[matches];\n  });\n}\n\nlet page = 1;\nlet hotCommentInst;\nlet commentInst;\nfunction App() {\n  const [hotComments, setHotComments] = useState([]);\n  const [comments, setComments] = useState([]);\n  const [loading, setLoading] = useState(false);\n\n  const loadMore = () => {\n    if (loading) return;\n    setLoading(true);\n    getData(50, 2027450 - page * 50)\n      .then((data) => {\n        setComments(comments.concat(data.comments));\n        page === 1 ? commentInst.pack() : commentInst.update();\n        page++;\n      })\n      .finally(() => {\n        setLoading(false);\n      });\n  };\n\n  useEffect(() => {\n    getData(20).then((data) => {\n      setHotComments(data.hotComments);\n      hotCommentInst.pack();\n    });\n    loadMore();\n    const sizeOpt = [\n      { columns: 2, gutter: 10 },\n      { mq: \"600px\", columns: 3, gutter: 10 },\n      { mq: \"800px\", columns: 4, gutter: 10 },\n      { mq: \"1000px\", columns: 5, gutter: 16 },\n      { mq: \"1130px\", columns: 5, gutter: 16 },\n    ];\n    hotCommentInst = Bricks({\n      container: \"#hot-comment-list\",\n      packed: \"data-packed\",\n      sizes: sizeOpt,\n    });\n    commentInst = Bricks({\n      container: \"#comment-list\",\n      packed: \"data-packed\",\n      sizes: sizeOpt,\n    });\n  }, []);\n\n  return (\n    <div className=\"App\">\n      <h1 className=\"title\">- 晴天の网易云评论 -</h1>\n      <div style={{ textAlign: \"center\" }}>\n        <iframe\n          src=\"//player.bilibili.com/player.html?aid=328746951&bvid=BV1VA411e7PM&cid=208118542&page=1\"\n          scrolling=\"no\"\n          border=\"0\"\n          frameborder=\"no\"\n          framespacing=\"0\"\n          allowfullscreen=\"true\"\n          style={{ width: 800, height: 500 }}\n        />\n      </div>\n\n      <h2 className=\"subtitle\">热评 TOP15</h2>\n      <div id=\"hot-comment-list\">\n        {hotComments.map(({ user, content, commentId, time }) => (\n          <CommentCard\n            key={commentId}\n            avatarUrl={user.avatarUrl}\n            nickname={user.nickname}\n            content={content}\n            time={time}\n          />\n        ))}\n      </div>\n      <h2 className=\"subtitle\">评论回忆</h2>\n      <div id=\"comment-list\">\n        {comments.map(({ user, content, commentId, time }) => (\n          <CommentCard\n            key={commentId}\n            avatarUrl={user.avatarUrl}\n            nickname={user.nickname}\n            content={content}\n            time={time}\n          />\n        ))}\n      </div>\n      <div className=\"load-more\">\n        <a className=\"load-more-button\" onClick={loadMore}>\n          {loading ? \"...\" : \"加载更多\"}\n        </a>\n      </div>\n    </div>\n  );\n}\n\nfunction CommentCard({ avatarUrl, nickname, content, time }) {\n  return (\n    <div className=\"grid-item\" style={{ backgroundColor: \"#fff\" }}>\n      <div className=\"userinfo\">\n        <img className=\"avatar\" src={avatarUrl} alt=\"avatar\" />\n      </div>\n      <div className=\"content\">\n        <span>{content}</span>\n        <div className=\"nickname\">- {nickname}</div>\n        <div className=\"time\">{dateFormat(time)}</div>\n      </div>\n    </div>\n  );\n}\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}